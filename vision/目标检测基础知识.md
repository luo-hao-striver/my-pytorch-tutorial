**:smile:：所用图片参考李沐教学视频**

# 边界框
- 边界框又称bounding box，是一个对象的**真实标签框**
- 可以用（左上x，左上y，右下x，右下y）或（左上x，左上y，宽，高）表示
  
# 锚框
- 锚框又称anchor box，大部分目标检测算法基于锚框
  - 提出多个锚框的区域
  - 预测锚框中是否含有关注的物体
  - 如果有，预测从锚框到真实边缘框的偏移

# IoU - 交并比
- IoU：intersection over union，用于计算两个框之间的相似度
- 通过计算bounding box和anchor box的IoU，判断相似度
  - 0表示无重叠，1表示完全重合（往往最终会趋近于1）

# 赋予锚框标号 和 非极大值抑制（NMS）的使用
- 赋予锚框标号
  - 每个锚框是一个训练样本
  - 一张图片的大量锚框，最终只会留下一个真实的，其余都是负样本
- 使用非极大值抑制（NMS）输出
  - 每个锚框预测一个边缘框
  - 选中非背景类的最大预测值
  - 去掉所有其它与它IoU值大于阈值（threshold）的预测
  - 重复上述过程，直到所有预测要么被选中，要么被丢弃
- 整体流程
  - 首先，生成大量赋予标号的锚框，
  - 然后，每个锚框作为一个样本进行训练，
  - 最后，使用NMS去掉冗余的锚框

# 兴趣区域池化层
- 兴趣区域又称RoI
- 给定一个锚框，均匀分割成$n \times m$块，输出每个块里的最大值
- 不管锚框多大，总是输出$nm$个值


# 目标检测模型介绍
- R-CNN模型
  - 区域卷积神经网络（region CNN,R-CNN）
  - 使用启发式搜索算法来选择锚框
  - 使用预训练模型对每个锚框抽取特征
  - 训练一个SVM对类别预测，训练一个线性回归模型对边缘框偏移预测
  ![R-CNN](docs/imgs/R-CNN.jpg 'R-CNN')
- Fast R-CNN模型 
  - 使用CNN对图片抽取特征
  - 使用RoI池化层对每个锚框生成固定长度特征
  - 相比较与R-CNN，不用SVM来判断了，并且CNN的特征加入池化
  ![Fast R-CNN](docs/imgs/Fast%20R-CNN.jpg)
- Faster R-CNN模型
  - 使用一个区域提议网络（RPN）来代替启发式搜索，获得更好的锚框
  ![Faster R-CNN](docs/imgs/Faster%20R-CNN.jpg)
- Mask R-CNN模型
  - 如果有像素级的标号，使用FCN利用这些信息，可做实例分割
  ![Mask R-CNN](docs/imgs/Mask%20R-CNN.jpg)
  ****
  **以上是双阶段（two-stage）的目标检测模型，即锚框预测（RPN）和主干预测两个阶段分步进行**

  **以下是单阶段（ont-stage）的目标检测模型，一步到位！！**
  ****
- SSD模型
  - 锚框的生成：对每个像素，生成多个以它为中心的锚框
  - 在多个段的输出上进行多尺度检测
    - 一个基础网络来抽取特征，然后多个卷积层块来减半高宽
    - 在每阶段都生成锚框：底部端拟合小物体，顶部段拟合大物体
    - 对每个锚框预测类别和边缘框
  ![SSD](docs/imgs/SSD.jpg)

- YOLO模型
  - 由于SSD中锚框大量重叠，YOLO将图片均分为$S \times S$个锚框
  - 每个锚框预测B个边缘框



